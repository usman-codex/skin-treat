🔎 checking possible migrations..

🔎 found a 'upgradeStorybookRelatedDependencies' migration:
╭ Automigration detected ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                                                                                                                     │
│   You're upgrading Storybook, but you are using community packages that might need to be upgraded as well. We recommend upgrading them:                                                             │
│   - @storybook/addon-essentials: 8.6.12 => 8.6.14                                                                                                                                                   │
│   - @storybook/addon-interactions: 8.6.12 => 8.6.14                                                                                                                                                 │
│   - @storybook/blocks: 8.6.12 => 8.6.14                                                                                                                                                             │
│   - @storybook/test: 8.6.12 => 8.6.14                                                                                                                                                               │
│                                                                                                                                                                                                     │
│   After upgrading, we will run the dedupe command, which could possibly have effects on dependencies that are not Storybook related.                                                                │
│   see: https://docs.npmjs.com/cli/commands/npm-dedupe                                                                                                                                               │
│                                                                                                                                                                                                     │
│   Attention: As these packages are maintained by the community, we cannot guarantee that they are compatible with the new version of Storybook. If you encounter any issues, please report them     │
│   to the package maintainers.                                                                                                                                                                       │
│                                                                                                                                                                                                     │
│   Do you want to proceed (upgrade the detected packages)?                                                                                                                                           │
│                                                                                                                                                                                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
? Do you want to run the 'upgradeStorybookRelatedDependencies' migration on your project? › (y/N)✔ Do you want to run the 'upgradeStorybookRelatedDependencies' migration on your project? … yes
Installing dependencies...


We upgraded 4 packages:
- @storybook/addon-essentials: 8.6.12 => 8.6.14
- @storybook/addon-interactions: 8.6.12 => 8.6.14
- @storybook/blocks: 8.6.12 => 8.6.14
- @storybook/test: 8.6.12 => 8.6.14

✅ ran upgradeStorybookRelatedDependencies migration

🔎 found a 'consolidated-imports' migration:
╭ Automigration detected ─────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                                                     │
│   Found package.json files that contain consolidated or renamed Storybook packages that need to be updated:                         │
│   - /Users/shota/github/react-compare-image/package.json                                                                            │
│                                                                                                                                     │
│   We will automatically rename the following packages:                                                                              │
│   - @storybook/blocks -> @storybook/addon-docs/blocks                                                                               │
│   - @storybook/test -> storybook/test                                                                                               │
│                                                                                                                                     │
│   These packages have been renamed or consolidated into the main storybook package and should be removed.                           │
│   The main storybook package will be added to devDependencies if not already present.                                               │
│                                                                                                                                     │
│   Would you like to:                                                                                                                │
│   1. Update these package.json files                                                                                                │
│   2. Scan your codebase and update any imports from these updated packages                                                          │
│                                                                                                                                     │
│   This will ensure your project is properly updated to use the new updated package structure and to use the latest package names.   │
│                                                                                                                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
? Do you want to run the 'consolidated-imports' migration on your project? › (Y/n)✔ Do you want to run the 'consolidated-imports' migration on your project? … yes
? Enter a custom glob pattern: › **/*.{mjs,cjs,js,jsx,ts,tsx,mdx}? Enter a custom glob pattern: › *? Enter a custom glob pattern: › **? Enter a custom glob pattern: › **/? Enter a custom glob pattern: › **/*✔ Enter a custom glob pattern: … **/*
Scanning for affected files...
Scanning 1206 files...
Installing dependencies...

An error occurred while installing dependencies.
❌ error when running consolidated-imports migration
HandledError: Error: Command failed with exit code 1: npm install
    at oi.installDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26034:75)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.run (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:289:50)
    ... 2 lines matching cause stack trace ...
    at async doUpgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:2517)
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)
    at async upgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:3048) {
  handled: true,
  cause: Error: Command failed with exit code 1: npm install
      at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)
      at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)
      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
      at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)
      at async oi.runInstall (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26644:5)
      at async oi.installDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26032:7)
      at async Object.run (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:289:50)
      at async runFixes (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:413:1798)
      at async automigrate (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:411:1834)
      at async doUpgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:2517) {
    shortMessage: 'Command failed with exit code 1: npm install',
    command: 'npm install',
    escapedCommand: 'npm install',
    exitCode: 1,
    signal: undefined,
    signalDescription: undefined,
    stdout: undefined,
    stderr: undefined,
    cwd: '/Users/shota/github/react-compare-image',
    failed: true,
    timedOut: false,
    isCanceled: false,
    killed: false
  }
}


🔎 found a 'removeAddonInteractions' migration:
╭ Automigration detected ─────────────────────────────────────────────────────────────────────────╮
│                                                                                                 │
│   @storybook/addon-interactions has been consolidated into Storybook core.                      │
│                                                                                                 │
│   We'll remove it from your dependencies and unregister it from your Storybook configuration.   │
│   The functionality will continue to work as before, but now it's built into Storybook core.    │
│                                                                                                 │
╰─────────────────────────────────────────────────────────────────────────────────────────────────╯
? Do you want to run the 'removeAddonInteractions' migration on your project? › (Y/n)✔ Do you want to run the 'removeAddonInteractions' migration on your project? … yes
Removing @storybook/addon-interactions...
❌ error when running removeAddonInteractions migration
Error: Command failed with exit code 7: npm exec -- storybook remove @storybook/addon-interactions --config-dir .storybook
npm error code EINVALIDPACKAGENAME
npm error Invalid package name "@storybook/addon-docs/blocks" of package "@storybook/addon-docs/blocks@8.6.14": name can only contain URL-friendly characters.
npm error A complete log of this run can be found in: /Users/shota/.npm/_logs/2025-06-12T05_01_26_304Z-debug-0.log
An error occurred while removing dependencies.
/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/bin/index.cjs:23
  throw error;
  ^

HandledError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions
    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)
    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {
  handled: true,
  cause: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions
      at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)
      at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)
      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
      at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)
      at async oi.runRemoveDeps (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26682:5)
      at async oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26156:9)
      at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)
      at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562
      at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {
    shortMessage: 'Command failed with exit code 1: npm uninstall @storybook/addon-interactions',
    command: 'npm uninstall @storybook/addon-interactions',
    escapedCommand: 'npm uninstall "@storybook/addon-interactions"',
    exitCode: 1,
    signal: undefined,
    signalDescription: undefined,
    stdout: undefined,
    stderr: undefined,
    cwd: '/Users/shota/github/react-compare-image',
    failed: true,
    timedOut: false,
    isCanceled: false,
    killed: false
  }
}

Node.js v22.14.0
Uninstalling @storybook/addon-interactions
Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions
Error: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions
    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)
    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)
    at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)
    at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)
    at async Object.run (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:316:119)
    at async runFixes (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:413:1798)
    at async automigrate (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:411:1834)
    at async doUpgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:2517)
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)
    at async upgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:3048) {
  shortMessage: 'Command failed with exit code 7: npm exec -- storybook remove @storybook/addon-interactions --config-dir .storybook',
  command: 'npm exec -- storybook remove @storybook/addon-interactions --config-dir .storybook',
  escapedCommand: 'npm exec -- storybook remove "@storybook/addon-interactions" --config-dir .storybook',
  exitCode: 7,
  signal: undefined,
  signalDescription: undefined,
  stdout: 'Uninstalling @storybook/addon-interactions\n' +
    'Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions\n' +
    '\x1B[38;2;241;97;97mError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions\x1B[39m\n' +
    '    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)\n' +
    '    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562\n' +
    '    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)',
  stderr: 'npm error code EINVALIDPACKAGENAME\n' +
    'npm error Invalid package name "@storybook/addon-docs/blocks" of package "@storybook/addon-docs/blocks@8.6.14": name can only contain URL-friendly characters.\n' +
    'npm error A complete log of this run can be found in: /Users/shota/.npm/_logs/2025-06-12T05_01_26_304Z-debug-0.log\n' +
    'An error occurred while removing dependencies.\n' +
    '/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/bin/index.cjs:23\n' +
    '  throw error;\n' +
    '  ^\n' +
    '\n' +
    'HandledError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions\n' +
    '    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)\n' +
    '    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562\n' +
    '    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {\n' +
    '  handled: true,\n' +
    '  cause: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions\n' +
    '      at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)\n' +
    '      at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)\n' +
    '      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '      at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)\n' +
    '      at async oi.runRemoveDeps (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26682:5)\n' +
    '      at async oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26156:9)\n' +
    '      at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)\n' +
    '      at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562\n' +
    '      at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {\n' +
    "    shortMessage: 'Command failed with exit code 1: npm uninstall @storybook/addon-interactions',\n" +
    "    command: 'npm uninstall @storybook/addon-interactions',\n" +
    `    escapedCommand: 'npm uninstall "@storybook/addon-interactions"',\n` +
    '    exitCode: 1,\n' +
    '    signal: undefined,\n' +
    '    signalDescription: undefined,\n' +
    '    stdout: undefined,\n' +
    '    stderr: undefined,\n' +
    "    cwd: '/Users/shota/github/react-compare-image',\n" +
    '    failed: true,\n' +
    '    timedOut: false,\n' +
    '    isCanceled: false,\n' +
    '    killed: false\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Node.js v22.14.0',
  cwd: '/Users/shota/github/react-compare-image',
  failed: true,
  timedOut: false,
  isCanceled: false,
  killed: false
}


🔎 found a 'renderer-to-framework' migration:
╭ Automigration detected ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                                                            │
│   As part of Storybook's evolution, we're moving from renderer-based to framework-based configuration.                                     │
│                                                                                                                                            │
│   This migration will:                                                                                                                     │
│   1. Update your source files to use framework-specific imports                                                                            │
│   2. Remove the renderer packages from your package.json                                                                                   │
│   3. Install the necessary framework dependencies                                                                                          │
│   Would you like to proceed with these changes?                                                                                            │
│                                                                                                                                            │
│   More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#moving-from-renderer-based-to-framework-based-configuration   │
│                                                                                                                                            │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
? Do you want to run the 'renderer-to-framework' migration on your project? › (Y/n)✔ Do you want to run the 'renderer-to-framework' migration on your project? … yes
? Enter a custom glob pattern to scan for story files (or press enter to use default): › **/*.{mjs,cjs,js,jsx,ts,tsx}? Enter a custom glob pattern to scan for story files (or press enter to use default): › *? Enter a custom glob pattern to scan for story files (or press enter to use default): › **? Enter a custom glob pattern to scan for story files (or press enter to use default): › **/? Enter a custom glob pattern to scan for story files (or press enter to use default): › **/*✔ Enter a custom glob pattern to scan for story files (or press enter to use default): … **/*

Migrating @storybook/react to @storybook/react-vite
Scanning 1206 files...
Updating package.json files...
Installing dependencies...

An error occurred while installing dependencies.
❌ error when running renderer-to-framework migration
HandledError: Error: Command failed with exit code 1: npm install
    at oi.installDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26034:75)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.run (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:355:533)
    ... 2 lines matching cause stack trace ...
    at async doUpgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:2517)
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)
    at async upgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:3048) {
  handled: true,
  cause: Error: Command failed with exit code 1: npm install
      at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)
      at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)
      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
      at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)
      at async oi.runInstall (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26644:5)
      at async oi.installDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26032:7)
      at async Object.run (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:355:533)
      at async runFixes (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:413:1798)
      at async automigrate (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:411:1834)
      at async doUpgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:2517) {
    shortMessage: 'Command failed with exit code 1: npm install',
    command: 'npm install',
    escapedCommand: 'npm install',
    exitCode: 1,
    signal: undefined,
    signalDescription: undefined,
    stdout: undefined,
    stderr: undefined,
    cwd: '/Users/shota/github/react-compare-image',
    failed: true,
    timedOut: false,
    isCanceled: false,
    killed: false
  }
}


🔎 found a 'remove-essentials' migration:
╭ Automigration detected ────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                        │
│   We've detected that you have @storybook/addon-essentials installed.                                  │
│                                                                                                        │
│   In Storybook 9.0, all features from @storybook/addon-essentials (except docs)                        │
│   have been moved into Storybook's core. You no longer need to install or configure them separately.   │
│                                                                                                        │
│   We'll remove @storybook/addon-essentials from your configuration and dependencies.                   │
│                                                                                                        │
│   Since you were using the docs feature, we'll install @storybook/addon-docs                           │
│   separately and add it to your configuration if it's not already present.                             │
│                                                                                                        │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────╯
? Do you want to run the 'remove-essentials' migration on your project? › (Y/n)✔ Do you want to run the 'remove-essentials' migration on your project? … yes
Removing @storybook/addon-essentials...
❌ error when running remove-essentials migration
Error: Command failed with exit code 7: npm exec -- storybook remove @storybook/addon-essentials --config-dir .storybook
npm error code EINVALIDPACKAGENAME
npm error Invalid package name "@storybook/addon-docs/blocks" of package "@storybook/addon-docs/blocks@8.6.14": name can only contain URL-friendly characters.
npm error A complete log of this run can be found in: /Users/shota/.npm/_logs/2025-06-12T05_01_36_102Z-debug-0.log
An error occurred while removing dependencies.
/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/bin/index.cjs:23
  throw error;
  ^

HandledError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials
    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)
    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {
  handled: true,
  cause: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials
      at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)
      at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)
      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
      at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)
      at async oi.runRemoveDeps (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26682:5)
      at async oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26156:9)
      at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)
      at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562
      at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {
    shortMessage: 'Command failed with exit code 1: npm uninstall @storybook/addon-essentials',
    command: 'npm uninstall @storybook/addon-essentials',
    escapedCommand: 'npm uninstall "@storybook/addon-essentials"',
    exitCode: 1,
    signal: undefined,
    signalDescription: undefined,
    stdout: undefined,
    stderr: undefined,
    cwd: '/Users/shota/github/react-compare-image',
    failed: true,
    timedOut: false,
    isCanceled: false,
    killed: false
  }
}

Node.js v22.14.0
Uninstalling @storybook/addon-essentials
Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials
Error: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials
    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)
    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)
    at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)
    at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)
    at async Object.run (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:342:348)
    at async runFixes (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:413:1798)
    at async automigrate (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:411:1834)
    at async doUpgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:2517)
    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)
    at async upgrade (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:3048) {
  shortMessage: 'Command failed with exit code 7: npm exec -- storybook remove @storybook/addon-essentials --config-dir .storybook',
  command: 'npm exec -- storybook remove @storybook/addon-essentials --config-dir .storybook',
  escapedCommand: 'npm exec -- storybook remove "@storybook/addon-essentials" --config-dir .storybook',
  exitCode: 7,
  signal: undefined,
  signalDescription: undefined,
  stdout: 'Uninstalling @storybook/addon-essentials\n' +
    'Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials\n' +
    '\x1B[38;2;241;97;97mError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials\x1B[39m\n' +
    '    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)\n' +
    '    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562\n' +
    '    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)',
  stderr: 'npm error code EINVALIDPACKAGENAME\n' +
    'npm error Invalid package name "@storybook/addon-docs/blocks" of package "@storybook/addon-docs/blocks@8.6.14": name can only contain URL-friendly characters.\n' +
    'npm error A complete log of this run can be found in: /Users/shota/.npm/_logs/2025-06-12T05_01_36_102Z-debug-0.log\n' +
    'An error occurred while removing dependencies.\n' +
    '/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/bin/index.cjs:23\n' +
    '  throw error;\n' +
    '  ^\n' +
    '\n' +
    'HandledError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials\n' +
    '    at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '    at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)\n' +
    '    at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562\n' +
    '    at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {\n' +
    '  handled: true,\n' +
    '  cause: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials\n' +
    '      at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)\n' +
    '      at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)\n' +
    '      at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '      at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)\n' +
    '      at async oi.runRemoveDeps (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26682:5)\n' +
    '      at async oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26156:9)\n' +
    '      at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)\n' +
    '      at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562\n' +
    '      at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {\n' +
    "    shortMessage: 'Command failed with exit code 1: npm uninstall @storybook/addon-essentials',\n" +
    "    command: 'npm uninstall @storybook/addon-essentials',\n" +
    `    escapedCommand: 'npm uninstall "@storybook/addon-essentials"',\n` +
    '    exitCode: 1,\n' +
    '    signal: undefined,\n' +
    '    signalDescription: undefined,\n' +
    '    stdout: undefined,\n' +
    '    stderr: undefined,\n' +
    "    cwd: '/Users/shota/github/react-compare-image',\n" +
    '    failed: true,\n' +
    '    timedOut: false,\n' +
    '    isCanceled: false,\n' +
    '    killed: false\n' +
    '  }\n' +
    '}\n' +
    '\n' +
    'Node.js v22.14.0',
  cwd: '/Users/shota/github/react-compare-image',
  failed: true,
  timedOut: false,
  isCanceled: false,
  killed: false
}


╭ Migration check ran with failures ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                                                                                    │
│   Successful migrations:                                                                                                                                           │
│                                                                                                                                                                    │
│   upgradeStorybookRelatedDependencies                                                                                                                              │
│                                                                                                                                                                    │
│   Failed migrations:                                                                                                                                               │
│                                                                                                                                                                    │
│   consolidated-imports:                                                                                                                                            │
│   Error: Command failed with exit code 1: npm install                                                                                                              │
│   removeAddonInteractions:                                                                                                                                         │
│   Command failed with exit code 7: npm exec -- storybook remove @storybook/addon-interactions --config-dir .storybook                                              │
│   npm error code EINVALIDPACKAGENAME                                                                                                                               │
│   npm error Invalid package name "@storybook/addon-docs/blocks" of package "@storybook/addon-docs/blocks@8.6.14": name can only contain URL-friendly characters.   │
│   npm error A complete log of this run can be found in: /Users/shota/.npm/_logs/2025-06-12T05_01_26_304Z-debug-0.log                                               │
│   An error occurred while removing dependencies.                                                                                                                   │
│   /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/bin/index.cjs:23                                                                             │
│     throw error;                                                                                                                                                   │
│     ^                                                                                                                                                              │
│                                                                                                                                                                    │
│   HandledError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions                                                                │
│       at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)                                     │
│       at process.processTicksAndRejections (node:internal/process/task_queues:105:5)                                                                               │
│       at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)                                         │
│       at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562                                                     │
│       at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {                                │
│     handled: true,                                                                                                                                                 │
│     cause: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions                                                                     │
│         at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)                                               │
│         at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)                                           │
│         at process.processTicksAndRejections (node:internal/process/task_queues:105:5)                                                                             │
│         at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)                                 │
│         at async oi.runRemoveDeps (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26682:5)                                   │
│         at async oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26156:9)                              │
│         at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)                                       │
│         at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562                                                   │
│         at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {                              │
│       shortMessage: 'Command failed with exit code 1: npm uninstall @storybook/addon-interactions',                                                                │
│       command: 'npm uninstall @storybook/addon-interactions',                                                                                                      │
│       escapedCommand: 'npm uninstall "@storybook/addon-interactions"',                                                                                             │
│       exitCode: 1,                                                                                                                                                 │
│       signal: undefined,                                                                                                                                           │
│       signalDescription: undefined,                                                                                                                                │
│       stdout: undefined,                                                                                                                                           │
│       stderr: undefined,                                                                                                                                           │
│       cwd: '/Users/shota/github/react-compare-image',                                                                                                              │
│       failed: true,                                                                                                                                                │
│       timedOut: false,                                                                                                                                             │
│       isCanceled: false,                                                                                                                                           │
│       killed: false                                                                                                                                                │
│     }                                                                                                                                                              │
│   }                                                                                                                                                                │
│                                                                                                                                                                    │
│   Node.js v22.14.0                                                                                                                                                 │
│   Uninstalling @storybook/addon-interactions                                                                                                                       │
│   Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions                                                                              │
│   Error: Error: Command failed with exit code 1: npm uninstall @storybook/addon-interactions                                                                       │
│       at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)                                     │
│       at process.processTicksAndRejections (node:internal/process/task_queues:105:5)                                                                               │
│       at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)                                         │
│       at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562                                                     │
│       at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)                                  │
│   renderer-to-framework:                                                                                                                                           │
│   Error: Command failed with exit code 1: npm install                                                                                                              │
│   remove-essentials:                                                                                                                                               │
│   Command failed with exit code 7: npm exec -- storybook remove @storybook/addon-essentials --config-dir .storybook                                                │
│   npm error code EINVALIDPACKAGENAME                                                                                                                               │
│   npm error Invalid package name "@storybook/addon-docs/blocks" of package "@storybook/addon-docs/blocks@8.6.14": name can only contain URL-friendly characters.   │
│   npm error A complete log of this run can be found in: /Users/shota/.npm/_logs/2025-06-12T05_01_36_102Z-debug-0.log                                               │
│   An error occurred while removing dependencies.                                                                                                                   │
│   /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/bin/index.cjs:23                                                                             │
│     throw error;                                                                                                                                                   │
│     ^                                                                                                                                                              │
│                                                                                                                                                                    │
│   HandledError: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials                                                                  │
│       at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)                                     │
│       at process.processTicksAndRejections (node:internal/process/task_queues:105:5)                                                                               │
│       at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)                                         │
│       at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562                                                     │
│       at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {                                │
│     handled: true,                                                                                                                                                 │
│     cause: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials                                                                       │
│         at makeError (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25224:67)                                               │
│         at handlePromise (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:25842:15)                                           │
│         at process.processTicksAndRejections (node:internal/process/task_queues:105:5)                                                                             │
│         at async oi.executeCommand (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26298:15)                                 │
│         at async oi.runRemoveDeps (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26682:5)                                   │
│         at async oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26156:9)                              │
│         at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)                                       │
│         at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562                                                   │
│         at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12) {                              │
│       shortMessage: 'Command failed with exit code 1: npm uninstall @storybook/addon-essentials',                                                                  │
│       command: 'npm uninstall @storybook/addon-essentials',                                                                                                        │
│       escapedCommand: 'npm uninstall "@storybook/addon-essentials"',                                                                                               │
│       exitCode: 1,                                                                                                                                                 │
│       signal: undefined,                                                                                                                                           │
│       signalDescription: undefined,                                                                                                                                │
│       stdout: undefined,                                                                                                                                           │
│       stderr: undefined,                                                                                                                                           │
│       cwd: '/Users/shota/github/react-compare-image',                                                                                                              │
│       failed: true,                                                                                                                                                │
│       timedOut: false,                                                                                                                                             │
│       isCanceled: false,                                                                                                                                           │
│       killed: false                                                                                                                                                │
│     }                                                                                                                                                              │
│   }                                                                                                                                                                │
│                                                                                                                                                                    │
│   Node.js v22.14.0                                                                                                                                                 │
│   Uninstalling @storybook/addon-essentials                                                                                                                         │
│   Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials                                                                                │
│   Error: Error: Command failed with exit code 1: npm uninstall @storybook/addon-essentials                                                                         │
│       at oi.removeDependencies (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:26158:94)                                     │
│       at process.processTicksAndRejections (node:internal/process/task_queues:105:5)                                                                               │
│       at async removeAddon (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/common/index.cjs:27444:32)                                         │
│       at async /Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/@storybook/cli/dist/bin/index.cjs:480:5562                                                     │
│       at async withTelemetry (/Users/shota/.npm/_npx/c20e0952e5abfa1b/node_modules/storybook/dist/core-server/index.cjs:36122:12)                                  │
│                                                                                                                                                                    │
│   You can find the full logs in /Users/shota/github/react-compare-image/migration-storybook.log                                                                    │
│                                                                                                                                                                    │
│   ─────────────────────────────────────────────────                                                                                                                │
│                                                                                                                                                                    │
│   If you'd like to run the migrations again, you can do so by running 'npx storybook automigrate'                                                                  │
│                                                                                                                                                                    │
│   The automigrations try to migrate common patterns in your project, but might not contain everything needed to migrate to the latest version of Storybook.        │
│                                                                                                                                                                    │
│   Please check the changelog and migration guide for manual migrations and more information: https://storybook.js.org/docs/migration-guide                         │
│   And reach out on Discord if you need help: https://discord.gg/storybook                                                                                          │
│                                                                                                                                                                    │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

